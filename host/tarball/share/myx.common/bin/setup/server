#!/usr/bin/env bash

set -e

if [ "`type -t UserRequireRoot`" != "function" ] ; then
. "/usr/local/share/myx.common/bin/user/requireRoot"
fi

UserRequireRoot

if [ "`type -t ReplaceLine`" != "function" ] ; then
. "/usr/local/share/myx.common/bin/lib/replaceLine"
fi

ReplaceLine /boot/loader.conf '^autoboot_delay=*' 'autoboot_delay="2"'

myx.common lib/tuneNetworkSpeed

# extra software
myx.common install/ensure/utilBashRsyncScreenSudo curl nano wget

ReplaceLine /usr/local/etc/sudoers '^%wheel ALL=*' '%wheel ALL=(ALL) ALL'

# rc.conf
sysrc \
	sshd_enable=YES \
	moused_enable=YES \
	ntpd_enable=YES \
	ntpdate_enable=YES \
	fsck_y_enable=YES

# Deliberately excluded:
#	powerd_enable=YES \


# update NTP date NOW!
ntpdate -u -b pool.ntp.org || true

test "$1" != "--postfix-mta" || myx.common lib/installPostfixMTA 
