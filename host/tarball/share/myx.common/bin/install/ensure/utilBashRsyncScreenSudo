#!/usr/bin/env bash

##############################################################################
#
# this script overrides the default implementation in order to try to install
# all packages required using single 'pkg' utility call (batch) 
#
##############################################################################

set -e

# It is better to be autonomous in this command, so instead of:
#   . /usr/local/share/myx.common/include/subr-freebsd.sh
#   UserRequireRoot
# we do:
test `id -u` = 0 || { echo '$1: Must be run under "root" user!'; exit 1; }

LIST=""

for PKG in bash rsync screen sudo $@ ; do
	[ ! -z "`which $PKG`" ] && echo "ensure: $PKG already present, skip" >&2 || LIST="$LIST $PKG"
done

[ -z "$LIST" ] && echo "all packages installed." >&2 || pkg install -y $LIST
