#!/usr/bin/env bash

set -e

. ${0%/*}/../../include/subr.sh

InstallAutorizedKey(){
	local NAME="$1" KEY="$2"
	local HOME="/home/$NAME"
	local KEYS="$HOME/.ssh/authorized_keys"
	
	mkdir -p "$HOME/.ssh"
	touch "$KEYS"
	
	InternReplaceLine "$KEYS" "$KEY" "$KEY"
	
	chown $NAME:$NAME "$KEYS"
	chmod 600 "$KEYS"
}


NAME="$1"
KEY="$2"

[ -z "$NAME" ] && echo "username is required!" && exit 1
[ -z "$KEY" ] && echo "key is required!" && exit 2

InstallAutorizedKey "$NAME" "$KEY"